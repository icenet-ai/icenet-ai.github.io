---
import Headline from '~/components/ui/Headline.astro';

const {
  id,
  title = '',
  subtitle = '',
  tagline = '',
  items = [],
  isDark = false,
  classes = {},
  bg = null,
} = Astro.props;
---

<script src="https://code.iconify.design/iconify-icon/3.0.0/iconify-icon.min.js"></script>

<!-- Using following for animations
 https://github.com/usaljs/usal -->
<script src="https://cdn.jsdelivr.net/npm/usal@latest/usal.min.js"></script>

<section id={id} class={`vertical-timeline max-w-7xl mx-auto px-6 ${classes.container ?? ''}`}>
  <div class="relative px-4 md:px-6 py-12 md:py-16 lg:py-20 text-default intersect-once intersect-quarter intercept-no-queue max-w-7xl mx-auto">
    <Headline title={title} subtitle={subtitle} tagline={tagline} />

    <div class="relative">
      {/* Center vertical line */}
      <div class="absolute left-1/2 top-0 transform -translate-x-1/2 w-1 bg-gray-300 dark:bg-slate-700 h-full"></div>

      {items.map((item, index) => {
        const isLeft = index % 2 === 0;
        return (
          <div
            key={index}
            class={`mb-10 w-full flex flex-col md:flex-row items-center relative
              ${isLeft ? 'md:flex-row' : 'md:flex-row-reverse'}`}
            style="min-height: 120px;"
	    data-usal="fade-u once"
          >
            {/* Dot + Icon */}
            <div class="absolute left-1/2 top-5 transform -translate-x-1/2 rounded-full bg-blue-600 ring-8 ring-white dark:ring-slate-900 dark:bg-blue-400 w-9 h-9 flex items-center justify-center z-10">
              <iconify-icon icon={item.icon} width="28" height="28" class="text-white"></iconify-icon>
            </div>

            {/* Content */}
            <div
              class={`bg-white dark:bg-slate-900 border border-gray-300 dark:border-slate-700 rounded-lg p-6 shadow-md w-full md:w-5/12
                ${isLeft ? 'md:mr-auto md:text-left' : 'md:ml-auto md:text-right'}`}
            >
              <time class="mb-1 text-sm font-normal leading-none text-gray-400 dark:text-gray-500 block">
                {item.date}
              </time>
              <h3 class="text-lg font-semibold text-gray-900 dark:text-white">{item.title}</h3>
              {item.subtitle && (
                <p class="mb-2 text-sm font-normal text-gray-500 dark:text-gray-400">{item.subtitle}</p>
              )}
              <p class="mb-2 text-base font-normal text-gray-700 dark:text-gray-300">{item.description}</p>

              <div class="flex space-x-2 justify-start md:justify-start">
                {item.youtube && (
                  <div class="mt-4 aspect-video w-full rounded-lg overflow-hidden shadow-lg">
                    <iframe
                      src={`https://www.youtube.com/embed/${item.youtube}`}
                      title="YouTube video"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                      allowfullscreen
                      loading="lazy"
                      class="w-full h-full border-0"
                    ></iframe>
                  </div>
                )}
                {item.link && (
                  <a
                    href={item.link}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="inline-block rounded bg-white px-4 py-2 text-sm font-medium text-gray-900 hover:bg-gray-100 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"
                  >
                    Open Link
                  </a>
                )}
              </div>
            </div>
          </div>
        );
      })}
    </div>
  </div>
</section>

